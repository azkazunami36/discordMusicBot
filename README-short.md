# 音楽bot
このプログラムは音楽botとしてDiscord Botを実行するプログラムです。

私の環境以外では**未検証です。**よって、他の環境でこのスクリプトを実行しても動作する保証はありません。

# はじめに
現在このbotはベータです。さまざまな配慮がされておらず、エラーが多く出てしまったり、ログが見づらかったり、未完成・無駄なコードが多々存在していたり、サーバーとして利用するには少し手を伸ばしづらいものとなっています。

とりあえず使ってみたいという方には「[音楽bot！の招待リンク](https://discord.com/oauth2/authorize?client_id=1028285721955553362&permissions=3264000&integration_type=0&scope=bot)」を利用してください。クリックするとDiscordでサーバーに追加することができます。フィードバックをする場合は、現時点でX(旧Twitter)の[@kazunami36_sum1](https://x.com/@kazunami36_sum1)へご連絡ください。手段は適当なポストにリプをしたり、メンションを行ったりするのが確実です。DMに連絡することも可能ですが、確実ではありません。

さらに、このREADME.mdすら完璧に書けていないので、さまざまな質問に関してもX(旧Twitter)アカウントにご連絡ください。TERMS.md、PRIVACY.mdについて、これはChatGPTによって作成されたものです。Discord Botの設定に使用するためのものです。こちらについても指摘をする場合はX(旧Twitter)にご連絡ください。

# 現時点の課題
このbotには多くの問題があります。
- /addコマンドの速度  
/addコマンドではApple Music、Spotify、YouTubeプレイリストなどを入力した際に取得完了まで時間がかかります。非同期処理を出来れば良いのですが、まだ準備中です。
- Apple MusicとSpotifyの精度
Apple MusicとSpotifyのURLは直接サービスから取得しているわけではなく、YouTubeに検索をかけて、決まったロジックを通して同じ曲であるだろうと推測する仕組みとなっています。その都合上間違った動画が出力されることも多々あります。
- MusicBrainzとの連携
このbotの特異性でもありますが、MusicBrainzを使用しています。しかし、MusicBrainzとYouTubeやApple Musicなどに関連づけるための仕組みがまだ完成していません。しかしAlbumInfoクラスを現在作成中のため、ここは解決する可能性が高いです。
- ニコニコ動画マイリスト追加機能
まだこのbotではニコニコ動画のマイリストを追加できません。

# 音楽bot側の操作方法
音楽botにはさまざまなコマンドが用意されています。それぞれ紹介します。

## /add
曲をキューに追加します。`/add text:[テキスト]`という構文です。対応しているサービスは以下です。
- YouTube(プレイリスト対応)
- ニコニコ動画
- Apple Music(テスト、アルバム対応)
- Spotify(テスト、アルバム・プレイリスト対応)

## /backseek
一発で再生位置を変更できる`/seek`のエイリアスです。標準は10秒です。`/backseek second:[数字]`で自由な時間戻せます。

## /callch
音楽botをコマンド操作したりするためのチャンネルを指定できます。

## /changetell
曲が自動で切り替わったりする時に、/playをしたチャンネルで通知をするかどうかを決められます。

## /delete
キューに入った曲を削除することができます。

## /help
ヘルプを表示しますが、ほとんど内容はありません。botのバージョンや、このリポジトリへのリンクが表示されます。

## /mblink
MusicBrainzに関する情報をみたり、設定したりすることができます。しかし、設定は特定のユーザー(仕様では私のユーザーID)しか設定ができません。

## /nextseek
一発で再生位置を変更できる`/seek`のエイリアスです。標準は10秒です。`/nextseek second:[数字]`で自由な時間進められます。

## /pitch
音程を変更できます。

## /play
キューに曲が入っている場合に再生を開始します。

## /repeat
キューの進め方を決定します。
- オフ: キューの再生が終わるとキューから削除されて次の曲に行きます。一度消された曲は再度`/add`されるまで追加されません。
- リピート: キューの再生が終わると自動でキューの末尾に曲が移動します。
- １曲リピート: キューの再生が終わってもキューの変更がされません。`/skip`コマンドで曲を変更することができます。

## /seek
再生位置を変更します。

## /skip
曲をスキップします。`/status`から曲の番号を選ぶと、その曲にスキップされます。その時、キューの順番は乱れません。

## /speed
再生速度を変更できます。

## /status
キューの状態、再生位置、音量、音程、速度、音楽bot設定などを見ることができます。

## /stop
再生を停止します。また、バグに見舞われている際にある程度リセットをすることができます。

## /test
テストコマンドです。大抵何も起こらないです。

## /volume
音量を調整します。
